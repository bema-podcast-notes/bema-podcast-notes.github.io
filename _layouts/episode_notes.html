<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {%- if page.episodeIndex %}
    {% assign episode = site.data.episodes[page.episodeIndex] %}
    {% assign previousEpisodeIndex = page.episodeIndex | minus: 1 %}
    {% assign previousEpisode = site.data.episodes[previousEpisodeIndex] %}
    {% assign nextEpisodeIndex = page.episodeIndex | plus: 1 %}
    {% assign nextEpisode = site.data.episodes[nextEpisodeIndex] %}
    {% endif -%}

    {%- if page.title_override %}
    {% assign title = page.title_override %}
    {%- elsif episode %}
    {% assign title = episode.title %}
    {% else %}
    {% assign title = "Unknown" %}
    {% endif -%}

    <title>{{ title }} - {{ site.title }}</title>
    <link rel="stylesheet" href="{{ '/assets/css/common.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/homepage.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/episode.css' | relative_url }}">
    <link rel="canonical" href="{{ site.url }}{{ page.url }}">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta name="title" content="{{ title }} - {{ site.title }}">
    <meta name="description" content="Get detailed notes by Adam Cole for episode {{ episode.title }} ({{ episode.subtitle }}) of the BEMA Discipleship Podcast.">
    <meta name="author" content="Notes by Adam Cole; Podcast by BEMA Discipleship">
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ title }} - {{ site.title }}">
    <meta property="og:description" content="Get detailed notes by Adam Cole for episode {{ episode.title }} ({{ episode.subtitle }}) of the BEMA Discipleship Podcast.">
    <meta property="og:url" content="{{ site.url }}{{ page.url }}">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ title }} - {{ site.title }}">
    <meta name="twitter:description" content="Get detailed notes by Adam Cole for episode {{ episode.title }} ({{ episode.subtitle }}) of the BEMA Discipleship Podcast.">

    {% if site.google_analytics %}
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ site.google_analytics }}');
    </script>
    {% endif %}
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="/" class="site-title">üìñ {{ site.title }}</a>
            <nav class="nav">
                <a href="/">Home</a>
                <a href="/#episodes">All Episodes</a>
                <a href="/search/">Search</a>
                <a href="/misc/">Resources</a>
            </nav>
        </div>
    </header>

    <!-- Episode Hero Section -->
    <section class="episode-hero">
        <div class="container">
            <div class="episode-meta-badge">
                <span class="session-badge">Session {{ episode.season }}</span>
                <span class="episode-number-badge">Episode {{ page.episodeNumber }}</span>
            </div>
            <h1>S{{ episode.season }} {{ title }}</h1>
            {%- if episode %}
            <p class="episode-subtitle">{{ episode.subtitle }}</p>
            <div class="episode-meta">
                <span>‚è±Ô∏è {{ episode.duration }}</span>
                <span>üìÖ {{ episode.pubDate }}</span>
            </div>
            {% endif -%}
        </div>
    </section>

    <!-- Episode Navigation -->
    <div class="container">
        <div class="episode-nav">
            <div class="episode-nav-left">
                {%- if previousEpisodeIndex >= 0 and previousEpisode %}
                <a href="{{ previousEpisode.link | replace: 'https://www.bemadiscipleship.com', '/ep' }}" class="btn btn-sm btn-primary">
                    ‚Üê Previous Episode
                </a>
                {% else %}
                <span class="btn btn-sm btn-disabled">‚Üê Previous Episode</span>
                {% endif -%}
            </div>
            <div class="episode-nav-center">
                <a href="/#episodes" class="btn btn-sm btn-primary">
                    üìã All Episodes
                </a>
            </div>
            <div class="episode-nav-right">
                {%- if nextEpisode %}
                <a href="{{ nextEpisode.link | replace: 'https://www.bemadiscipleship.com', '/ep' }}" class="btn btn-sm btn-primary">
                    Next Episode ‚Üí
                </a>
                {% else %}
                <span class="btn btn-sm btn-disabled">Next Episode ‚Üí</span>
                {% endif -%}
            </div>
        </div>
    </div>

    <!-- Episode Player & Info -->
    {%- if episode %}
    <div class="container">
        <div class="section-container episode-player-section">
            <h2>üéß Listen to This Episode</h2>
            <div class="player-container">
                <iframe src="{{ episode.playerURL }}?theme=dark" width="100%" height="200" frameborder="0" scrolling="no"></iframe>
            </div>

            <div class="episode-info-grid">
                <div class="info-card">
                    <h3>Episode Details</h3>
                    <p><strong>Episode Number:</strong> {{ page.episodeNumber }}</p>
                    <p><strong>Session:</strong> {{ episode.season }}</p>
                    <p><strong>Duration:</strong> {{ episode.duration }}</p>
                    <p><strong>Published:</strong> {{ episode.pubDate }}</p>
                </div>

                <div class="info-card">
                    <h3>Listen on BEMA</h3>
                    <p>Visit the official BEMA website to listen to this episode and explore more resources.</p>
                    <a href="{{ episode.link }}" target="_blank" class="btn btn-primary">
                        Open on BEMA ‚Üí
                    </a>
                </div>
            </div>

            {%- if episode.description %}
            <div class="episode-description">
                <h3>About This Episode</h3>
                <p>{{ episode.description }}</p>
            </div>
            {% endif -%}
        </div>
    </div>
    {% endif -%}

    <!-- Episode Notes -->
    <div class="container">
        <article class="section-container episode-notes-section">
            <div class="notes-header">
                <h2>üìù Episode Notes</h2>
                <p class="notes-disclaimer">
                    <em>Note: The following notes are handwritten by me, Adam, and I reserve the right to be wrong. These reflect my personal understanding and interpretation.</em>
                </p>
            </div>

            <div class="notes-content content-area">
                {{ content }}
            </div>
        </article>
    </div>

    <!-- Bottom Navigation -->
    <div class="container">
        <div class="episode-nav">
            <div class="episode-nav-left">
                {%- if previousEpisodeIndex >= 0 and previousEpisode %}
                <a href="{{ previousEpisode.link | replace: 'https://www.bemadiscipleship.com', '/ep' }}" class="btn btn-sm btn-primary">
                    ‚Üê Previous Episode
                </a>
                {% else %}
                <span class="btn btn-sm btn-disabled">‚Üê Previous Episode</span>
                {% endif -%}
            </div>
            <div class="episode-nav-center">
                <a href="{{ site.github_repo }}{{ page.path }}" class="btn btn-sm btn-outline" target="_blank">
                    ‚úèÔ∏è Edit on GitHub
                </a>
            </div>
            <div class="episode-nav-right">
                {%- if nextEpisode %}
                <a href="{{ nextEpisode.link | replace: 'https://www.bemadiscipleship.com', '/ep' }}" class="btn btn-sm btn-primary">
                    Next Episode ‚Üí
                </a>
                {% else %}
                <span class="btn btn-sm btn-disabled">Next Episode ‚Üí</span>
                {% endif -%}
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p class="footer-title"><strong>{{ site.title }}</strong></p>
            <p class="footer-description">These are my personal notes from the BEMA Podcast by Marty Solomon and Brent Billings.</p>
            <p class="footer-disclaimer">These notes reflect my understanding and are not intended to represent the beliefs of the podcast hosts.</p>
            <p class="footer-links">
                <a href="mailto:{{ site.email }}">Contact</a> |
                <a href="https://github.com/{{ site.github_username }}">GitHub</a> |
                <a href="https://www.bemadiscipleship.com/">Official BEMA Site</a>
            </p>
        </div>
    </footer>

</body>
</html>
